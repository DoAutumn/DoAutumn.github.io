---
title: ÂæÆÂâçÁ´Ø‰πãAngularÂ∫îÁî®ÊñπÊ°à
toc: true
date: 2024-11-08 19:10:17
tags: [ÂæÆÂâçÁ´Ø, worktile/planet]
category: Angular
---
## ‰ªÄ‰πàÊòØÂæÆÂâçÁ´Ø
> Techniques, strategies and recipes for building a **modern web app** with **multiple teams** that can **ship features independently**. -- [Micro Frontends](https://micro-frontends.org/)
> ÂæÆÂâçÁ´ØÊòØ‰∏ÄÁßçÂ§ö‰∏™Âõ¢ÈòüÈÄöËøáÁã¨Á´ãÂèëÂ∏ÉÂäüËÉΩÁöÑÊñπÂºèÊù•ÂÖ±ÂêåÊûÑÂª∫Áé∞‰ª£Âåñ web Â∫îÁî®ÁöÑÊäÄÊúØÊâãÊÆµÂèäÊñπÊ≥ïÁ≠ñÁï•„ÄÇ

ÂæÆÂâçÁ´ØÊû∂ÊûÑÂÖ∑Â§á‰ª•‰∏ãÂá†‰∏™Ê†∏ÂøÉ‰ª∑ÂÄºÔºö
- ÊäÄÊúØÊ†àÊó†ÂÖ≥
  ‰∏ªÊ°ÜÊû∂‰∏çÈôêÂà∂Êé•ÂÖ•Â∫îÁî®ÁöÑÊäÄÊúØÊ†àÔºåÂæÆÂ∫îÁî®ÂÖ∑Â§áÂÆåÂÖ®Ëá™‰∏ªÊùÉ
- Áã¨Á´ãÂºÄÂèë„ÄÅÁã¨Á´ãÈÉ®ÁΩ≤
  ÂæÆÂ∫îÁî®‰ªìÂ∫ìÁã¨Á´ãÔºåÂâçÂêéÁ´ØÂèØÁã¨Á´ãÂºÄÂèëÔºåÈÉ®ÁΩ≤ÂÆåÊàêÂêé‰∏ªÊ°ÜÊû∂Ëá™Âä®ÂÆåÊàêÂêåÊ≠•Êõ¥Êñ∞
- Â¢ûÈáèÂçáÁ∫ß
  Âú®Èù¢ÂØπÂêÑÁßçÂ§çÊùÇÂú∫ÊôØÊó∂ÔºåÊàë‰ª¨ÈÄöÂ∏∏ÂæàÈöæÂØπ‰∏Ä‰∏™Â∑≤ÁªèÂ≠òÂú®ÁöÑÁ≥ªÁªüÂÅöÂÖ®ÈáèÁöÑÊäÄÊúØÊ†àÂçáÁ∫ßÊàñÈáçÊûÑÔºåËÄåÂæÆÂâçÁ´ØÊòØ‰∏ÄÁßçÈùûÂ∏∏Â•ΩÁöÑÂÆûÊñΩÊ∏êËøõÂºèÈáçÊûÑÁöÑÊâãÊÆµÂíåÁ≠ñÁï•
- Áã¨Á´ãËøêË°åÊó∂
  ÊØè‰∏™ÂæÆÂ∫îÁî®‰πãÈó¥Áä∂ÊÄÅÈöîÁ¶ªÔºåËøêË°åÊó∂Áä∂ÊÄÅ‰∏çÂÖ±‰∫´

ÂæÆÂâçÁ´ØÊû∂ÊûÑÊó®Âú®Ëß£ÂÜ≥Âçï‰ΩìÂ∫îÁî®Âú®‰∏Ä‰∏™Áõ∏ÂØπÈïøÁöÑÊó∂Èó¥Ë∑®Â∫¶‰∏ãÔºåÁî±‰∫éÂèÇ‰∏éÁöÑ‰∫∫Âëò„ÄÅÂõ¢ÈòüÁöÑÂ¢ûÂ§ö„ÄÅÂèòËøÅÔºå‰ªé‰∏Ä‰∏™ÊôÆÈÄöÂ∫îÁî®ÊºîÂèòÊàê‰∏Ä‰∏™Â∑®Áü≥Â∫îÁî®([Frontend Monolith](https://www.youtube.com/watch?v=pU1gXA0rfwc))ÂêéÔºåÈöè‰πãËÄåÊù•ÁöÑÂ∫îÁî®‰∏çÂèØÁª¥Êä§ÁöÑÈóÆÈ¢ò„ÄÇËøôÁ±ªÈóÆÈ¢òÂú®‰ºÅ‰∏öÁ∫ß Web Â∫îÁî®‰∏≠Â∞§ÂÖ∂Â∏∏ËßÅ„ÄÇ

Êõ¥Â§öÂÖ≥‰∫éÂæÆÂâçÁ´ØÁöÑÁõ∏ÂÖ≥‰ªãÁªçÔºåÊé®ËçêÂ§ßÂÆ∂ÂèØ‰ª•ÂéªÁúãËøôÂá†ÁØáÊñáÁ´†Ôºö
- [Micro Frontends](https://micro-frontends.org/)
- [Micro Frontends from martinfowler.com](https://martinfowler.com/articles/micro-frontends.html)
- [ÂèØËÉΩÊòØ‰Ω†ËßÅËøáÊúÄÂÆåÂñÑÁöÑÂæÆÂâçÁ´ØËß£ÂÜ≥ÊñπÊ°à](https://zhuanlan.zhihu.com/p/78362028)
- [ÂæÆÂâçÁ´ØÁöÑÊ†∏ÂøÉ‰ª∑ÂÄº](https://zhuanlan.zhihu.com/p/95085796)

---
‰∏æ‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑ‰æãÂ≠êÔºåÂÅáÂ¶Ç‰∏Ä‰∏™ Web Â∫îÁî®Êúâ N Â§ö‰∏™ÂäüËÉΩÊ®°ÂùóÔºåÊØîÂ¶ÇÊúâÊï∞ÊçÆÁÆ°ÁêÜ„ÄÅÂ§ßÂ±èÈÖçÁΩÆ„ÄÅÊµÅÁ®ãÁºñËæë„ÄÅÂÆâÂÖ®Êä•ÂëäÔºåÊØè‰∏™Ê®°ÂùóËá™Ë∫´ÂÖ∂ÂÆûÂ∑≤ÁªèÂæàÂ§çÊùÇ‰∫ÜÔºåÂ¶ÇÊûúÊîæÂà∞‰∏Ä‰∏™Â∑•Á®ãÈáåÔºåÂπ∂‰∏îÊòØÁî±‰∏Ä‰∏™Âõ¢ÈòüË¥üË¥£ÔºåÈÇ£ÂÄí‰πüÈóÆÈ¢ò‰∏çÂ§ßÔºåÈ°∂Â§öÂ∞±ÊòØÊâìÂåÖÊÖ¢‰∏ÄÁÇπ„ÄÇ‰ΩÜÂ¶ÇÊûúÊòØÁî±‰∏çÂêåÁöÑÂõ¢ÈòüË¥üË¥£ÔºåÂπ∂‰∏îÊØè‰∏™Ê®°ÂùóÂèàÈúÄË¶ÅÁã¨Á´ãÂèëÂ∏ÉÔºåÁã¨Á´ãÈÉ®ÁΩ≤ÔºåÈÇ£‰πàËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂæÆÂâçÁ´ØÊû∂ÊûÑÂ∞±ÊòæÂæóÂ∞§‰∏∫ÈáçË¶Å‰∫Ü„ÄÇ

Âú®‰∫ÜËß£Âà∞ÂæÆÂâçÁ´ØÊû∂ÊûÑ‰πãÂâçÔºåÊàë‰ª¨ÁîöËá≥Â∞ùËØïËøáÂ∞ÜÂêÑ‰∏™ÂäüËÉΩÊ®°ÂùóÊûÑÂª∫‰∏∫‰æùËµñÂåÖÔºåÁÑ∂ÂêéÁî±‰∏Ä‰∏™Áã¨Á´ãÁöÑ„ÄÅÁ±ª‰ºº Portal ÁöÑÂ∑•Á®ãÂÆâË£ÖËøô‰∫õ‰æùËµñÂåÖÔºåÈÄöËøáË∑ØÁî±Êù•Âä†ËΩΩËøô‰∫õÊ®°Âùó„ÄÇËøôÁßçÊñπÊ°àËôΩÁÑ∂ËÉΩÂ§üÂú®ÂºÄÂèëÊÄÅÂ∞ÜÂêÑ‰∏™Ê®°ÂùóÁã¨Á´ãÂºÄÊù•Ôºå‰ΩÜÂú®Áîü‰∫ßÁéØÂ¢ÉÂÖ∂ÂÆûËøòÊòØÂ∞ÜÊâÄÊúâÊ®°ÂùóÊâìÂåÖÂà∞‰∏ÄËµ∑‰∫ÜÔºåÂÄòËã•‰∏Ä‰∏™Ê®°ÂùóÂá∫Áé∞ÈóÆÈ¢òÔºåËøòÊòØÈúÄË¶ÅÂ∞ÜÊâÄÊúâÊ®°Âùó‰∏ÄÂπ∂ÊâìÂåÖÊõ¥Êñ∞ÔºåÁã¨Á´ãÂèëÂ∏É„ÄÅÈÉ®ÁΩ≤ÁöÑÊ†∏ÂøÉÈóÆÈ¢òËøòÊòØÊ≤°ÊúâËß£ÂÜ≥„ÄÇ

## [qiankun](https://qiankun.umijs.org/zh)
> ÂèØËÉΩÊòØ‰Ω†ËßÅËøáÊúÄÂÆåÂñÑÁöÑÂæÆÂâçÁ´ØËß£ÂÜ≥ÊñπÊ°àüßê

ÂÖ≥‰∫é qiankun ÁöÑ‰ΩøÁî®ÔºåÊúâÊú∫‰ºöÂÜçÂéªÊï¥ÁêÜ„ÄÇ

## [Planet](http://planet.ngnice.com/)
> Angular Ê°ÜÊû∂‰∏ãÊó†ÊáàÂèØÂáªÁöÑÂæÆÂâçÁ´ØÊ°ÜÊû∂Âíå‰∏Ä‰ΩìÂåñËß£ÂÜ≥ÊñπÊ°à

Áî±‰∫éÂÖ¨Âè∏ÁöÑÊäÄÊúØÊ†àÊòØ AngularÔºåÊâÄ‰ª•ÈÄâÊã©‰∫ÜÂÆÉ„ÄÇÂØπ‰∫éËæÉÊó©ÁâàÊú¨(Â¶Ç@worktile/planet@12„ÄÅ@worktile/planet@13)Ôºå‰ªñ‰ª¨Âõ¢ÈòüÂπ∂Ê≤°ÊúâÊèê‰æõÈìæÊé•‰∏≠Â¶ÇÊ≠§ËØ¶ÁªÜÁöÑÂ∏ÆÂä©ÁΩëÁ´ôÔºåÂè™ËÉΩ‰æùËµñ README ÂíåÊ∫êÁ†ÅÊë∏Á¥¢‰ΩøÁî®Ôºå‰∏≠Èó¥Ë∏©‰∫Ü‰∏çÂ∞ëÂùëÔºåÊâÄ‰ª•ËÆ∞ÂΩï‰∏ãÊó©ÊúüÁâàÊú¨ÁöÑ‰ΩøÁî®Ê≠•È™§„ÄÇ

ËøôÈáå‰ª• Angular@13 ‰∏∫‰æãÔºå‰ΩøÁî® Angular CLI ÂàùÂßãÂåñÂ∑•Á®ã„ÄÇ

### ‰∏Ä„ÄÅÂàùÂßãÂåñÂ∑•Á®ãÂπ∂ÂÆâË£ÖÁõ∏ÂÖ≥‰æùËµñ
```shell
ng new portal --routing -S -g --style=less
ng g app1 --routing -S --style=less  // Angular Êú¨Ë∫´ÊîØÊåÅÂú®‰∏Ä‰∏™Â∑•Á®ã‰∏≠ÂàõÂª∫Â§ö‰∏™Â∫îÁî®ÔºåËøôÈáåÁöÑ app1 app2 ‰∏∫Â≠êÂ∫îÁî®ÂêçÁß∞ÔºåÂêéÈù¢‰ºöÁî®Âà∞
ng g app2 --routing -S --style=less

npm i @worktile/planet@13 --save
npm i @angular-builders/custom-webpack@13 webpack-assets-manifest@5 --save-dev
```

### ‰∫å„ÄÅ‰∏ªÂ∫îÁî®ÈÖçÁΩÆ
#### 1. Ê†áËÆ∞ÊòØÂê¶‰∏∫ÈõÜÊàêÁéØÂ¢É
Êàë‰ª¨ÊúüÊúõÂ≠êÂ∫îÁî®Âú®ÂºÄÂèëÊó∂ÔºåËÉΩÂ§üÁã¨Á´ãËøêË°åÔºåËÉΩÂ§üÊòæÁ§∫ÂêÑËá™Â≠êÊ®°ÂùóÂØπÂ∫îÁöÑÂØºËà™ËèúÂçïÔºåÊØîÂ¶ÇÊï∞ÊçÆÁÆ°ÁêÜÂ≠êÂ∫îÁî®ÔºåËøòÂåÖÂê´Êï∞ÊçÆÂ∫ìÁÆ°ÁêÜ„ÄÅÊñá‰ª∂Á≥ªÁªüÁÆ°ÁêÜÁ≠âÔºåÂú®Êú¨Âú∞ÂºÄÂèëÊó∂ÔºåÂ¶ÇÊûúÂè™ËÉΩÈÄöËøáÂú∞ÂùÄÊ†èËæìÂÖ• URL ÂàáÊç¢È°µÈù¢ÔºåÈÇ£Â∞±Â§™È∫ªÁÉ¶‰∫Ü„ÄÇ

ËÄåÂΩìÂ≠êÂ∫îÁî®Ë¢´ Portal ÈõÜÊàêÊó∂ÔºåÂ≠êÂ∫îÁî®ÁöÑÂØºËà™ËèúÂçïÂ∞Ü‰∏çÂÜçÊòæÁ§∫ÔºåËÄåÊòØÁî± Portal Áªü‰∏ÄÊèê‰æõ„ÄÇÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶Å‰∏ÄÁßçÊñπÂºèÔºåËÆ©Â≠êÂ∫îÁî®Áü•ÈÅìÂΩìÂâçÊòØÂê¶Ë¢´ÈõÜÊàêÂà∞ Portal ‰∏≠Ôºå‰ªéËÄåÂÜ≥ÂÆöÊòØÂê¶ÊòæÁ§∫ÂØºËà™ËèúÂçï„ÄÇ

‰∏∫Ê≠§ÔºåÊàë‰ª¨Âú® Portal ‰∏≠ÂàõÂª∫‰∏Ä‰∏™ÂÖ®Â±ÄÂèòÈáè `window.__POWERED_BY_PLANET__`ÔºåÂÄº‰∏∫ trueÔºåË°®Á§∫ÂΩìÂâçÊòØÈõÜÊàêÁéØÂ¢É„ÄÇÂΩìÂ≠êÂ∫îÁî®ÂºÄÂßãËøêË°åÊó∂ÔºåÈÄöËøáËØ•ÂèòÈáèÂà§Êñ≠ÂΩìÂâçÁéØÂ¢ÉÔºå‰ªéËÄåÂÜ≥ÂÆöÊòØÂê¶ÊòæÁ§∫ÂØºËà™ËèúÂçïÔºàÂ≠êÂ∫îÁî®ÂçïÁã¨ÂêØÂä®Êó∂ÊòØËé∑Âèñ‰∏çÂà∞ËØ•ÂèòÈáèÁöÑÔºåÂõ†‰∏∫ÂÆÉÊòØÂú® Portal ‰∏≠ÂÆö‰πâÁöÑÔºâ„ÄÇ
```ts
// src/main.ts
...

(window as any).__POWERED_BY_PLANET__ = true;

platformBrowserDynamic().bootstrapModule(AppModule)
  .catch(err => console.error(err));
```
#### 2. ÈÖçÁΩÆË∑ØÁî±
`@worktile/planet` ÈááÁî®‰∏ªÂ∫îÁî®ÂíåÂ≠êÂ∫îÁî®‰∫íÁõ∏ÂêåÊ≠•Ë∑ØÁî±ÁöÑÊñπÂºèÂÆûÁé∞È°µÈù¢ÂàáÊç¢ÔºåÂΩìËøõÂÖ•Â≠êÂ∫îÁî®Ë∑ØÁî±Êó∂Ôºå‰∏ªÂ∫îÁî®ÂÖ∂ÂÆûÊòØÊ≤°ÊúâÂØπÂ∫îÁöÑË∑ØÁî±‰ø°ÊÅØÁöÑÔºåÊâÄ‰ª•ÈúÄË¶ÅÂØºËà™Âà∞Á©∫ÁôΩÈ°µÈù¢ÔºåÁÑ∂ÂêéÁî±Â≠êÂ∫îÁî®Êé•ÁÆ°Ë∑ØÁî±ÊòæÁ§∫ÂØπÂ∫îÁöÑÈ°µÈù¢„ÄÇ
```ts
// src/app/app.module.ts
...

const routes: Routes = [
  {
    path: '**',  // ÈáçÁÇπÊòØËøôÈáå
    component: EmptyComponent
  }
];

@NgModule({
  declarations: [
    AppComponent,
  ],
  imports: [
    BrowserModule,
    BrowserAnimationsModule,
    NgxPlanetModule,  // ÂêåÊó∂ËøôÈáåÂºïÂÖ•‰∫Ü NgxPlanetModule
    RouterModule.forRoot(routes, { useHash: true }),
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
```
#### 3. Ê≥®ÂÜåÂ≠êÂ∫îÁî®
```ts
// src/app/app.component.ts
import { Component, OnInit } from '@angular/core';
import { Planet, SwitchModes } from '@worktile/planet';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.less']
})
export class AppComponent implements OnInit {

  get loadingDone() {
    return this.planet.loadingDone;
  }

  constructor(
    private planet: Planet
  ) { }

  ngOnInit() {
    this.planet.setOptions({
      switchMode: SwitchModes.coexist,
      errorHandler: error => {
        console.error(`Failed to load resource, error:`, error);
      }
    });

    this.planet.registerApps([
      {
        name: 'app1',
        hostParent: '#app-host-container',
        routerPathPrefix: '/app1/',
        resourcePathPrefix: '/app1/',
        preload: true,
        scripts: [
          'main.js',
          'polyfills.js'
        ],
        styles: [
          'styles.css'
        ],
        manifest: '/app1/assets-manifest.json'
      },
      {
        name: 'app2',
        hostParent: '#app-host-container',
        hostClass: 'thy-layout',
        routerPathPrefix: '/app2/',
        resourcePathPrefix: '/app2/',
        preload: true,
        scripts: [
          'main.js',
          'polyfills.js'
        ],
        styles: [
          'styles.css'
        ],
        manifest: '/app2/assets-manifest.json'
      }
    ]);

    // start monitor route changes
    // get apps to active by current path
    // load static resources which contains javascript and css
    // bootstrap angular sub app module and show it
    this.planet.start();
  }
}
```
#### 4. ÈÖçÁΩÆÂ≠êÂ∫îÁî®ËèúÂçï„ÄÅÂÆπÂô®
```html
<!-- src/app/app.component.html -->
<nav>
  <a [routerLink]="['/app1/test']" routerLinkActive="active">Â∫îÁî®1</a>
  <a [routerLink]="['/app2/test']" routerLinkActive="active">Â∫îÁî®2</a>
</nav>
<router-outlet></router-outlet>
<div id="app-host-container"></div>
<div *ngIf="!loadingDone">Âä†ËΩΩ‰∏≠...</div>
```
#### 5. ÈÖçÁΩÆ‰ª£ÁêÜÔºåÊñπ‰æøÂºÄÂèë
```js
// Ê†πÁõÆÂΩï‰∏ãÊñ∞Â¢ûÊñá‰ª∂ proxy.conf.jsÔºåÂÜÖÂÆπÂ¶Ç‰∏ãÔºö
const PROXY_CONFIG = {
  "/app1": {
    "target": 'http://localhost:3000',
    "secure": false
  },
  "/app2": {
    "target": 'http://localhost:3100',
    "secure": false
  }
}

module.exports = PROXY_CONFIG
```

### ‰∏â„ÄÅÂ≠êÂ∫îÁî®ÈÖçÁΩÆ
#### 1. ‰øÆÊîπÁ®ãÂ∫èÂÖ•Âè£
ÂâçÈù¢ÊèêÂà∞Êàë‰ª¨ÊúüÊúõÂ≠êÂ∫îÁî®Âú®ÂºÄÂèëÊó∂ÔºåËÉΩÂ§üÁã¨Á´ãËøêË°åÔºåÊâÄ‰ª•‰∏çËÉΩÁõ¥Êé•‰ΩøÁî® `@worktile/planet` Êèê‰æõÁöÑÂ¶Ç‰∏ãÊñπÊ≥ïÔºö
```ts
defineApplication('app1', (portalApp: PlanetPortalApplication) => {
  return platformBrowserDynamic([
    {
      provide: PlanetPortalApplication,
      useValue: portalApp
    }
  ])
    .bootstrapModule(AppModule)
    .then(appModule => {
      return appModule;
    })
    .catch(error => {
      console.error(error);
      return null;
    });
});
```
ËÄåÊòØÈáçÊñ∞Êèê‰æõ‰∏Ä‰∏™ `dyBootstrap` ÊñπÊ≥ïÔºåÂú®ÂÜÖÈÉ®ÈÄöËøá `window.__POWERED_BY_PLANET__` Âà§Êñ≠ÊòØÂê¶‰∏∫ÈõÜÊàêÁéØÂ¢É„ÄÇ‰∏∫‰∫ÜÊñπ‰æøÂêÑÂ≠êÂ∫îÁî®‰ΩøÁî®ÔºåÂ∞ÜÂÖ∂Â∞ÅË£ÖÂà∞ `projects/frame/public-api` ‰∏≠ÔºåÂÖ∑‰Ωì‰ª£Á†ÅÂ¶Ç‰∏ãÔºö
```ts
import { Type, CompilerOptions, NgModuleRef } from "@angular/core"
import { platformBrowserDynamic } from "@angular/platform-browser-dynamic"
import { PlanetPortalApplication, defineApplication } from "@worktile/planet"
import { BootstrapOptions } from "@worktile/planet/application/planet-application-ref"

/**
 * Â∫îÁî®ÂêØÂä®ÂáΩÊï∞ÔºåÊ†πÊçÆÊòØÂê¶‰∏∫ÈõÜÊàêÁéØÂ¢ÉÔºåÂÜ≥ÂÆöÂ¶Ç‰ΩïÂêØÂä®Â∫îÁî®
 * @param appName Â∫îÁî®ÂêçÁß∞
 * @returns 
 */
export const dyBootstrap = (appName: string) => {
  return {
    bootstrapModule<M>(moduleType: Type<M>, compilerOptions?: (CompilerOptions & BootstrapOptions) | Array<CompilerOptions & BootstrapOptions>): Promise<NgModuleRef<M>> {
      return new Promise((resolve, reject) => {

        if ((window as any).__POWERED_BY_PLANET__) {
          return defineApplication(appName, {
            template: `<app-${appName}></app-${appName}>`,
            bootstrap: (portalApp: PlanetPortalApplication) => {
              return platformBrowserDynamic([
                {
                  provide: PlanetPortalApplication,
                  useValue: portalApp
                }
              ]).bootstrapModule(moduleType, compilerOptions)
            }
          })
        }
        else {
          return platformBrowserDynamic().bootstrapModule(moduleType, compilerOptions)
        }

      })
    }
  }
}
```
ÈÇ£‰πàÂ≠êÂ∫îÁî®ÁöÑÂêØÂä®ÂáΩÊï∞Â∞±ÂèòÊàê‰∫ÜÔºö
```ts
// projects/app1/src/main.ts
import { dyBootstrap } from 'projects/frame/public-api';
// Â∞Ü
platformBrowserDynamic().bootstrapModule(AppModule)
  .catch(err => console.error(err));
// Êîπ‰∏∫
dyBootstrap('app1').bootstrapModule(AppModule)
  .catch(err => console.error(err));
```
#### 2. ‰øÆÊîπÊâìÂåÖÈÖçÁΩÆ
**Ê∑ªÂä†Ëá™ÂÆö‰πâ webpack Êñá‰ª∂**
```js
// Ê†πÁõÆÂΩï‰∏ãÊñ∞Â¢ûÊñá‰ª∂ extr-webpack.config.jsÔºåÂÜÖÂÆπÂ¶Ç‰∏ãÔºö
const WebpackAssetsManifest = require('webpack-assets-manifest');

module.exports = {
    optimization: {
        runtimeChunk: false
    },
    plugins: [new WebpackAssetsManifest()]
};
```
**‰øÆÊîπ angular.json**
```json
// angular.json
"build": {
  "builder": "@angular-builders/custom-webpack:browser",
  "options": {
    "customWebpackConfig": {
      "path": "./extra-webpack.config.js",
      "mergeStrategies": {
        "externals": "replace",
        "module.rules": "append"
      }
    },
    "baseHref": "/app1/",
    "deployUrl": "/app1/",
    ...
  },
  "configurations": {
    ...
    "development": {
      ...
      "vendorChunk": false,
      ...
    }
  }
},
"serve": {
  "builder": "@angular-builders/custom-webpack:dev-server",
  ...
}
```
#### 3. ‰øÆÊîπ‰∏ÄÁ∫ßÊ®°Âùó
```js
// projects/app1/src/index.html
// Â∞Ü
<app-root></app-root>
// Êîπ‰∏∫
<app-app1></app-app1>


// projects/app1/src/app/app.component.ts
// Â∞Ü
selector: 'app-root',
// Êîπ‰∏∫
selector: 'app-app1',


// projects/app1/src/app/app.component.html
// Âè™‰øùÁïô
<router-outlet></router-outlet>
// Âç≥ÂèØ
```
#### 4. Ê∑ªÂä†‰∏ÄÁ∫ßË∑ØÁî±
```ts
// projects/app1/src/app/app.module.ts
import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { HttpClientModule } from '@angular/common/http';
import { BrowserAnimationsModule } from "@angular/platform-browser/animations";
import { RouterModule, Routes } from '@angular/router';
import { EmptyComponent } from '@worktile/planet';
import { NzMessageModule } from 'ng-zorro-antd/message';

import { BasicComponent, BasicModule } from 'projects/frame/public-api';

import { AppComponent } from './app.component';

const routes: Routes = [
  {
    path: '',
    redirectTo: 'app1',
    pathMatch: 'full'
  },
  {
    path: 'app1',
    component: BasicComponent,  // BasicComponent ÊòØ‰∏Ä‰∏™Âü∫Á°ÄÁªÑ‰ª∂ÔºåÂåÖÂê´ÂØºËà™Ê†èÂíå‰æßËæπÊ†èÔºåÂíå dyBootstrap ‰∏ÄÊ†∑Ôºå‰∏∫‰∫ÜÊñπ‰æøÂêÑÂ≠êÂ∫îÁî®‰ΩøÁî®ÔºåÂ∞ÜÂÖ∂Â∞ÅË£ÖÂà∞ `projects/frame/public-api` ‰∏≠
                                // ÂÜÖÈÉ®ÂÆûÁé∞‰∫Ü Ê†πÊçÆ window.__POWERED_BY_PLANET__ Âà§Êñ≠ÊòØÂê¶ÊòØÈõÜÊàêÁéØÂ¢ÉÔºåÂ¶ÇÊûúÊòØÔºåÂàô‰∏çÊòæÁ§∫ÂØºËà™ËèúÂçï
    children: [
      {
        path: 'test',
        loadChildren: () => import('./test/test.module').then(m => m.TestModule),
        data: { firstMenu: true, alias: 'ÊµãËØï' }  // ‰∏∫‰∫ÜÊñπ‰æøÂ≠êÂ∫îÁî®ÂºÄÂèëÔºåËøôÈáåÂ∞ÜË∑ØÁî±ÂØπÂ∫îÁöÑËèúÂçï‰ø°ÊÅØÁõ¥Êé•ÂÜôÂú®Ë∑ØÁî±ÈÖçÁΩÆ‰∏≠ÔºåÁî± `projects/frame/public-api` Êèê‰æõÊñπÊ≥ïËß£ÊûêË∑ØÁî±ÈÖçÁΩÆÔºåÁîüÊàêËèúÂçï
      }
    ]
  },
  {
    path: '**',
    component: EmptyComponent
  },
]

@NgModule({
  declarations: [
    AppComponent,
  ],
  imports: [
    BrowserModule,
    BrowserAnimationsModule,
    HttpClientModule,
    BasicModule,
    NzMessageModule,
    RouterModule.forRoot(routes, { useHash: true })
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
```
```js
// basic.component.ts
import { Component, OnInit } from '@angular/core';

/**
 * ÂçïÂ∫îÁî®ÂºÄÂèëÊó∂ÁöÑÂü∫Á°ÄÂ∏ÉÂ±Ä„ÄÇËèúÂçï‰ªéRoutes‰∏≠Ëß£ÊûêËÄåÊù•
 */
@Component({
  selector: 'dy-basic',
  templateUrl: './basic.component.html',
  styleUrls: ['./basic.component.less']
})
export class BasicComponent {
  multiApp = (window as any).__POWERED_BY_PLANET__;
}


// basic.component.html
<router-outlet *ngIf="multiApp; else devTemp"></router-outlet>

<ng-template #devTemp>
  <div class="layout pr">

    <div class="header">ËøôÈáåÊòØÂØºËà™Ê†è</div>
    
    <div class="layout fdr container pr">
      <div class="menu">ËøôÈáåÊòØ‰æßËæπÊ†è</div>
      <div class="layout">
        <router-outlet></router-outlet>
      </div>
    </div>
    
  </div>
</ng-template>
```

### Âõõ„ÄÅ‰øÆÊîπÂêØÂä®ËÑöÊú¨
```json
// package.json
"scripts": {
  "ng": "ng",
  "start": "ng serve --proxy-config proxy.config.js",
  "start1": "ng serve app1 --port 3000",
  "start2": "ng serve app2 --port 3100"
},
```
‰πãÂêéÂ∞±ÂèØ‰ª•ÈÄöËøá `npm run start` ÂêØÂä®‰∏ªÂ∫îÁî®Ôºå`npm run start1` ÂêØÂä®Â≠êÂ∫îÁî®1Ôºå`npm run start2` ÂêØÂä®Â≠êÂ∫îÁî®2 ËøõË°åÊµãËØï‰∫Ü„ÄÇ